#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
增强版CCUS知识图谱Schema - 更详细的专业关系类型
包含CCUS全产业链的详细关系定义
"""

# 核心CCUS技术领域的详细关系
ccus_enhanced_schema = {
    # === 碳捕集技术相关 ===
    "碳捕集技术": [
        "适用排放源",        # 技术适用的排放源类型（燃煤电厂、水泥厂、钢铁厂等）
        "捕集原理",          # 技术捕集机理（化学吸收、物理吸收、膜分离等）
        "捕集效率",          # 技术的CO2捕集效率
        "能耗特征",          # 技术的能源消耗特点
        "技术供应商",        # 技术开发或提供方
        "商业化程度",        # 技术商业化成熟度
        "成本范围",          # 技术经济成本区间
        "技术集成",          # 与其他技术的集成关系
        "工艺流程",          # 技术的具体工艺步骤
        "关键设备",          # 技术需要的核心设备
        "操作条件",          # 技术的操作温度、压力等条件
        "环境影响"           # 技术对环境的影响
    ],

    # === 碳运输技术相关 ===
    "碳运输技术": [
        "运输方式",          # 管道、船舶、卡车等运输方式
        "运输距离",          # 适用的运输距离范围
        "运输容量",          # 运输能力规模
        "运输成本",          # 单位运输成本
        "基础设施需求",      # 需要的基础设施投资
        "安全要求",          # 运输安全标准和要求
        "技术标准",          # 运输技术标准规范
        "运营商",            # 运输服务提供商
        "路线规划",          # 运输路径和网络
        "监测系统",          # 运输过程监测技术
        "应急响应",          # 应急处理能力
        "环境风险"           # 运输环境风险评估
    ],

    # === 碳利用技术相关 ===
    "碳利用技术": [
        "利用途径",          # CO2利用的具体途径
        "转化产品",          # CO2转化生成的产品
        "转化效率",          # CO2转化利用效率
        "催化剂",            # 利用过程中的催化剂
        "反应条件",          # 利用技术的反应条件
        "经济可行性",        # 利用技术的经济性
        "产品市场",          # 转化产品的市场前景
        "技术路线",          # 具体的技术实现路线
        "能源需求",          # 利用过程的能源需求
        "副产物",            # 利用过程的副产物
        "生命周期评价",      # 全生命周期环境影响
        "规模化前景"         # 技术规模化应用前景
    ],

    # === 碳储存技术相关 ===
    "碳储存技术": [
        "储存机理",          # CO2储存的物理化学机理
        "储存介质",          # 储存的地质介质类型
        "储存容量",          # 地质储存容量评估
        "储存安全性",        # 储存的长期安全性
        "监测技术",          # 储存过程监测方法
        "注入技术",          # CO2注入工艺技术
        "密封性能",          # 地质储层密封特性
        "风险评估",          # 储存风险识别评估
        "选址标准",          # 储存选址技术标准
        "地质勘探",          # 储存场地勘探技术
        "数值模拟",          # 储存过程数值模拟
        "验证方法"           # 储存效果验证方法
    ],

    # === CCUS项目相关 ===
    "CCUS项目": [
        "项目类型",          # 示范项目、商业项目等
        "技术路线",          # 项目采用的技术路线
        "建设规模",          # 项目建设规模
        "投资规模",          # 项目总投资额
        "实施主体",          # 项目实施的主要机构
        "合作模式",          # 项目合作组织模式
        "融资方式",          # 项目融资渠道和方式
        "建设周期",          # 项目建设时间安排
        "运营模式",          # 项目运营管理模式
        "经济效益",          # 项目经济收益分析
        "环境效益",          # 项目环境贡献
        "技术创新",          # 项目技术创新点
        "示范意义",          # 项目示范推广价值
        "推广前景",          # 项目复制推广前景
        "挑战因素",          # 项目面临的主要挑战
        "成功因素"           # 项目成功的关键因素
    ],

    # === CCUS政策相关 ===
    "CCUS政策": [
        "政策类型",          # 补贴政策、税收政策、监管政策等
        "政策目标",          # 政策要达到的目标
        "支持机制",          # 具体的政策支持机制
        "激励措施",          # 政策激励措施
        "约束机制",          # 政策约束和惩罚机制
        "适用对象",          # 政策适用的主体范围
        "实施机构",          # 政策执行主管部门
        "配套措施",          # 政策配套实施措施
        "评估机制",          # 政策效果评估机制
        "国际对比",          # 与国际政策的对比
        "政策协调",          # 与其他政策的协调
        "政策演进"           # 政策发展变化趋势
    ],

    # === CCUS产业相关 ===
    "CCUS产业": [
        "产业链条",          # CCUS产业链环节
        "市场规模",          # 产业市场规模
        "发展阶段",          # 产业发展所处阶段
        "竞争格局",          # 产业竞争态势
        "技术壁垒",          # 产业技术门槛
        "投资机会",          # 产业投资机遇
        "商业模式",          # 产业商业运作模式
        "价值链",            # 产业价值创造链条
        "标准规范",          # 产业技术标准规范
        "人才需求",          # 产业人才需求结构
        "国际合作",          # 产业国际合作态势
        "发展趋势"           # 产业未来发展趋势
    ],

    # === CCUS机构相关 ===
    "CCUS机构": [
        "机构性质",          # 企业、科研院所、政府部门等
        "业务专长",          # 机构专业能力领域
        "技术能力",          # 机构技术研发能力
        "项目经验",          # 机构项目实施经验
        "合作网络",          # 机构合作伙伴网络
        "资质能力",          # 机构相关资质认证
        "研发投入",          # 机构研发投资情况
        "人才队伍",          # 机构人才团队结构
        "国际地位",          # 机构国际影响力
        "发展战略",          # 机构发展战略规划
        "竞争优势",          # 机构核心竞争优势
        "业务拓展"           # 机构业务扩展方向
    ],

    # === CCUS地质相关 ===
    "CCUS地质": [
        "地质构造",          # 地质构造特征
        "储层特性",          # 储层物理化学特性
        "盖层特征",          # 盖层密封性能
        "地质历史",          # 地质形成演化历史
        "地球物理特征",      # 地球物理勘探特征
        "地球化学特征",      # 地球化学环境特征
        "储存潜力评估",      # 地质储存潜力评价
        "适宜性分级",        # 储存适宜性等级
        "风险因素",          # 地质储存风险要素
        "监测指标",          # 地质监测关键指标
        "模型参数",          # 地质建模参数
        "勘探方法"           # 地质勘探技术方法
    ],

    # === CCUS经济相关 ===
    "CCUS经济": [
        "成本构成",          # CCUS成本结构组成
        "经济模型",          # CCUS经济评价模型
        "投资回报",          # 投资回报率分析
        "现金流",            # 项目现金流预测
        "敏感性因素",        # 经济敏感性影响因素
        "融资结构",          # 项目融资结构设计
        "盈利模式",          # 商业盈利模式
        "成本下降路径",      # 成本下降技术路径
        "经济激励",          # 经济激励政策需求
        "市场机制",          # 市场化运作机制
        "价格机制",          # 碳价格形成机制
        "经济可行性"         # 经济可行性评估
    ],

    # === CCUS环境相关 ===
    "CCUS环境": [
        "环境效益",          # CCUS环境正面效益
        "环境影响",          # CCUS潜在环境影响
        "生态安全",          # 对生态系统安全影响
        "环境监测",          # 环境影响监测方法
        "环境标准",          # 环境保护标准要求
        "环境管理",          # 环境管理制度体系
        "环境风险",          # 环境风险识别评估
        "环境修复",          # 环境损害修复措施
        "环境评价",          # 环境影响评价方法
        "减排效果",          # 温室气体减排效果
        "环境协同效益",      # 与其他环境政策协同
        "可持续性"           # CCUS可持续发展性
    ]
}

# 扩展的关系映射，将更多专业术语映射到标准关系
enhanced_relation_mapping = {
    # 技术成熟度相关
    "技术成熟度": "商业化程度",
    "技术就绪度": "商业化程度",
    "TRL等级": "商业化程度",
    "工业化水平": "商业化程度",

    # 技术原理相关
    "工作原理": "捕集原理",
    "分离机理": "捕集原理",
    "吸收机理": "捕集原理",
    "反应机理": "捕集原理",

    # 效率相关
    "分离效率": "捕集效率",
    "去除效率": "捕集效率",
    "回收率": "捕集效率",
    "转化率": "转化效率",

    # 成本相关
    "技术成本": "成本范围",
    "投资成本": "投资规模",
    "运营成本": "成本范围",
    "建设成本": "投资规模",

    # 项目相关
    "示范项目": "项目类型",
    "商业项目": "项目类型",
    "工业项目": "项目类型",
    "试点项目": "项目类型",

    # 储存相关
    "地质储存": "储存机理",
    "深部咸水层": "储存介质",
    "油气藏": "储存介质",
    "不可开采煤层": "储存介质",
    "玄武岩": "储存介质",

    # 监测相关
    "地震监测": "监测技术",
    "地球化学监测": "监测技术",
    "地球物理监测": "监测技术",
    "微震监测": "监测技术",

    # 政策相关
    "碳税": "支持机制",
    "碳交易": "支持机制",
    "补贴政策": "支持机制",
    "税收优惠": "激励措施",

    # 产业相关
    "产业化": "发展阶段",
    "商业化": "发展阶段",
    "规模化": "发展阶段",
    "示范阶段": "发展阶段",

    # 机构相关
    "研发机构": "机构性质",
    "科研院所": "机构性质",
    "高等院校": "机构性质",
    "国有企业": "机构性质",
    "民营企业": "机构性质",
    "外资企业": "机构性质",

    # 地质相关
    "沉积盆地": "地质构造",
    "断层": "地质构造",
    "背斜": "地质构造",
    "向斜": "地质构造",
    "储层": "储层特性",
    "盖层": "盖层特征",

    # 环境相关
    "减排": "减排效果",
    "温室气体": "减排效果",
    "碳中和": "环境效益",
    "碳达峰": "环境效益"
}

# 实体类型定义
ccus_entity_types = [
    "碳捕集技术",
    "碳运输技术",
    "碳利用技术",
    "碳储存技术",
    "CCUS项目",
    "CCUS政策",
    "CCUS产业",
    "CCUS机构",
    "CCUS地质",
    "CCUS经济",
    "CCUS环境",
    "技术设备",
    "地理位置",
    "数值指标",
    "时间",
    "人员",
    "标准规范"
]

def get_relation_type(entity1_type, entity2_type, relation_text):
    """
    根据实体类型和关系文本确定关系类型
    """
    # 标准化关系文本
    relation_key = relation_text.strip()

    # 首先检查映射表
    if relation_key in enhanced_relation_mapping:
        return enhanced_relation_mapping[relation_key]

    # 根据实体类型推断关系
    if entity1_type in ccus_enhanced_schema:
        for relation in ccus_enhanced_schema[entity1_type]:
            if relation_key in relation or relation in relation_key:
                return relation

    # 返回原始关系文本作为默认值
    return relation_key

def validate_ccus_relation(subject_type, relation, object_type):
    """
    验证CCUS关系的合理性
    """
    if subject_type in ccus_enhanced_schema:
        valid_relations = ccus_enhanced_schema[subject_type]
        if relation in valid_relations:
            return True

    # 检查是否在映射表中
    if relation in enhanced_relation_mapping.values():
        return True

    return False

# 导出配置
__all__ = [
    'ccus_enhanced_schema',
    'enhanced_relation_mapping',
    'ccus_entity_types',
    'get_relation_type',
    'validate_ccus_relation'
]